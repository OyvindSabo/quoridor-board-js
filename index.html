<script src='../quoridor-js/quoridor.js'></script>

</script>

<script>
const WALL_COLOR = 'AntiqueWhite';
const BASE_COLOR = 'Black';
const PLAYER_1_COLOR = 'White';
const PLAYER_2_COLOR = 'Black';
const cell = (piece = 0) => `<td style="background:Brown;color:${piece === 1 ? PLAYER_1_COLOR : PLAYER_2_COLOR};width:10%;height:10%;font-size:373%;text-align:center">${[1, 2].includes(piece) ? '♟' : '&nbsp;'}</td>`;
const verticalCell = (wall = false) => `<td style="background:${wall ? WALL_COLOR : BASE_COLOR};width:1%;height:10%">`;
const horizontalCell = (wall = false) => `<td style="background:${wall ? WALL_COLOR : BASE_COLOR};width:10%;height:1%">`;
const miniCell = (wall = false) => `<td style="background:${wall ? WALL_COLOR : BASE_COLOR};width:1%;height:1%">`;
const row = content => `<tr>${content}</tr>`

const rowBetweenRows = content => `<tr>${content}</tr>`

const initBoard = (containerId, quoridorGame) => {
    const container = document.getElementById(containerId);
    const wallColor = 'Orange';
    const borderColor = 'Red';
    let board = quoridorGame.board;
    let walls = quoridorGame.walls;
    let htmlBoard = ``;
    /*for (let wallIndex = 1; wallIndex <= 10; wallIndex++) {
      if (this.wallCount[2] >= wallIndex) {
        board += `${wallColor}║${reset}`;
      } else {
        board += `${borderColor}━${reset}`;
      }
      if (wallIndex === 10) {
        board += `${borderColor}━━┓${reset}`;
      } else {
        board += `${borderColor}━━━${reset}`;
      }
    }
    for (let wallIndex = 1; wallIndex <= 10; wallIndex++) {
      if (this.wallCount[2] >= wallIndex) {
        board += `${wallColor}║${reset}`;
      } else {
        board += `${borderColor}╳${reset}`;
      }
      if (wallIndex === 10) {
        board += `${borderColor}╳╳┃${reset}`;
      } else {
        board += `${borderColor}╳╳╳${reset}`;
      }
    }*/
    for (let y = 9; y > 0; y--) { // For each row from the top
      let row = ''
      Object.keys(board).forEach(x => { // For each column
        row += cell(board[x][y]);
        if (x !== "i") {
          if (
            (y < 9 && walls[x][y].v) || (y > 1 && walls[x][y - 1].v)
          ) {
            row += verticalCell(true); // wall = true
          } else if (x !== "i") {
            row += verticalCell();
          }
        }
      });
      htmlBoard += `<tr>${row}</tr>`;
      if (y > 1) {
        row = '';
        Object.keys(board).forEach((x, index, array) => {
          if (
            y < 9 &&
            ((x !== "i" && walls[x][y - 1].h) ||
              (x !== "a" && walls[array[index - 1]][y - 1].h))
          ) {
            row += horizontalCell(true); // wall = true;
          } else {
            row += horizontalCell();
          }
          if (x !== "i") {
            if (x !== "i" && y < 9 && walls[x][y - 1].h) {
              row += miniCell(true); // wall = true;
            } else if (y > 1 && walls[x][y - 1].v) {
              row += verticalCell(true);
            } else {
              row += miniCell();
            }
          }
        });
        htmlBoard += `<tr>${row}</tr>`;
      }
    }
    /*
    for (let wallIndex = 1; wallIndex <= 10; wallIndex++) {
      if (this.wallCount[1] >= wallIndex) {
        board += `${wallColor}║${reset}`;
      } else {
        board += `${borderColor}╳${reset}`;
      }
      if (wallIndex === 10) {
        board += `${borderColor}╳╳┃${reset}`;
      } else {
        board += `${borderColor}╳╳╳${reset}`;
      }
    }
    board += `\n${borderColor}┗━━${reset}`;
    for (let wallIndex = 1; wallIndex <= 10; wallIndex++) {
      if (this.wallCount[1] >= wallIndex) {
        board += `${wallColor}║${reset}`;
      } else {
        board += `${borderColor}━${reset}`;
      }
      if (wallIndex === 10) {
        board += `${borderColor}━━┛${reset}`;
      } else {
        board += `${borderColor}━━━${reset}`;
      }
    }*/
    htmlBoard += '</table>';
    container.innerHTML = `<table style="width:100%;height:100%;border-collapse:collapse;">${htmlBoard}</table>`
}
</script>

<div id="quoridorBoardContainer" style="width:720px;height:720px;">Board failed to load</div>

<script>
    const game = new Quoridor();
    console.log(game)
    game.move({ x: 'e', y: 2, w: 'h' });
    console.log(game.ascii());
    initBoard('quoridorBoardContainer', game);
    
</script>